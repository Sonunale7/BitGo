{"dependencies":[{"name":"firebase/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":135,"index":135}}],"key":"ZF/J3nfk5GUgbzXl84BqV1IxYEE=","exportNames":["*"],"imports":1}},{"name":"../config/firebase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":136},"end":{"line":2,"column":46,"index":182}}],"key":"K/SZPG5sPeV1upVh8dao26aG7MQ=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":183},"end":{"line":3,"column":69,"index":252}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"generateMessageId\", {\n    enumerable: true,\n    get: function () {\n      return generateMessageId;\n    }\n  });\n  Object.defineProperty(exports, \"getChatId\", {\n    enumerable: true,\n    get: function () {\n      return getChatId;\n    }\n  });\n  Object.defineProperty(exports, \"saveMessagesLocally\", {\n    enumerable: true,\n    get: function () {\n      return saveMessagesLocally;\n    }\n  });\n  Object.defineProperty(exports, \"getLocalMessages\", {\n    enumerable: true,\n    get: function () {\n      return getLocalMessages;\n    }\n  });\n  Object.defineProperty(exports, \"addMessageLocally\", {\n    enumerable: true,\n    get: function () {\n      return addMessageLocally;\n    }\n  });\n  Object.defineProperty(exports, \"updateMessageStatusLocally\", {\n    enumerable: true,\n    get: function () {\n      return updateMessageStatusLocally;\n    }\n  });\n  Object.defineProperty(exports, \"sendMessageToFirebase\", {\n    enumerable: true,\n    get: function () {\n      return sendMessageToFirebase;\n    }\n  });\n  Object.defineProperty(exports, \"getMessageQueue\", {\n    enumerable: true,\n    get: function () {\n      return getMessageQueue;\n    }\n  });\n  Object.defineProperty(exports, \"saveMessageQueue\", {\n    enumerable: true,\n    get: function () {\n      return saveMessageQueue;\n    }\n  });\n  Object.defineProperty(exports, \"addToQueue\", {\n    enumerable: true,\n    get: function () {\n      return addToQueue;\n    }\n  });\n  Object.defineProperty(exports, \"removeFromQueue\", {\n    enumerable: true,\n    get: function () {\n      return removeFromQueue;\n    }\n  });\n  Object.defineProperty(exports, \"subscribeToNewMessages\", {\n    enumerable: true,\n    get: function () {\n      return subscribeToNewMessages;\n    }\n  });\n  var _firebaseDatabase = require(_dependencyMap[0], \"firebase/database\");\n  var _configFirebase = require(_dependencyMap[1], \"../config/firebase\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[2], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const QUEUE_KEY = '@bitgo_message_queue';\n  const MESSAGES_KEY = '@bitgo_messages_';\n\n  // Track active listeners to prevent duplicates\n  const activeListeners = new Map();\n\n  // Generate unique message ID locally\n  const generateMessageId = () => {\n    return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  };\n\n  // Get chat ID from two user phones (sorted for consistency)\n  const getChatId = (phone1, phone2) => {\n    const sorted = [phone1, phone2].sort();\n    return `${sorted[0]}_${sorted[1]}`;\n  };\n\n  // Save messages locally for a chat\n  const saveMessagesLocally = async (chatId, messages) => {\n    try {\n      await AsyncStorage.default.setItem(MESSAGES_KEY + chatId, JSON.stringify(messages));\n    } catch (e) {\n      // Silent fail in production\n    }\n  };\n\n  // Get messages from local storage\n  const getLocalMessages = async chatId => {\n    try {\n      const data = await AsyncStorage.default.getItem(MESSAGES_KEY + chatId);\n      return data ? JSON.parse(data) : [];\n    } catch (e) {\n      return [];\n    }\n  };\n\n  // Add single message to local storage\n  const addMessageLocally = async (chatId, message) => {\n    try {\n      const messages = await getLocalMessages(chatId);\n      const exists = messages.find(m => m.id === message.id);\n      if (!exists) {\n        messages.push(message);\n        // Keep only last 100 messages locally\n        const trimmed = messages.slice(-100);\n        await saveMessagesLocally(chatId, trimmed);\n      }\n    } catch (e) {\n      // Silent fail in production\n    }\n  };\n\n  // Update message status locally\n  const updateMessageStatusLocally = async (chatId, messageId, status) => {\n    try {\n      const messages = await getLocalMessages(chatId);\n      const index = messages.findIndex(m => m.id === messageId);\n      if (index !== -1) {\n        messages[index].status = status;\n        await saveMessagesLocally(chatId, messages);\n      }\n    } catch (e) {\n      // Silent fail in production\n    }\n  };\n\n  // Send message to Firebase (minimal payload) - checks for duplicate before writing\n  const sendMessageToFirebase = async (chatId, message) => {\n    try {\n      const messageRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${chatId}/messages/${message.id}`);\n\n      // Check if message already exists (prevent duplicates on retry)\n      const snapshot = await (0, _firebaseDatabase.get)(messageRef);\n      if (snapshot.exists()) {\n        return true;\n      }\n\n      // Minimal payload only - text, sender, timestamp, status\n      await (0, _firebaseDatabase.set)(messageRef, {\n        text: message.text,\n        sender: message.sender,\n        timestamp: message.timestamp,\n        status: 'sent'\n      });\n\n      // Update chat meta for sorting (lastMessage, lastTimestamp)\n      const metaRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${chatId}/meta`);\n      await (0, _firebaseDatabase.set)(metaRef, {\n        lastMessage: message.text.substring(0, 50),\n        lastTimestamp: message.timestamp\n      });\n      return true;\n    } catch (e) {\n      return false;\n    }\n  };\n\n  // Queue management for offline messages\n\n  const getMessageQueue = async () => {\n    try {\n      const data = await AsyncStorage.default.getItem(QUEUE_KEY);\n      return data ? JSON.parse(data) : [];\n    } catch (e) {\n      return [];\n    }\n  };\n  const saveMessageQueue = async queue => {\n    try {\n      await AsyncStorage.default.setItem(QUEUE_KEY, JSON.stringify(queue));\n    } catch (e) {\n      // Silent fail in production\n    }\n  };\n  const addToQueue = async (chatId, message) => {\n    const queue = await getMessageQueue();\n    // Check if already in queue\n    const exists = queue.find(q => q.message.id === message.id);\n    if (!exists) {\n      queue.push({\n        chatId,\n        message,\n        retryCount: 0\n      });\n      await saveMessageQueue(queue);\n    }\n  };\n  const removeFromQueue = async messageId => {\n    const queue = await getMessageQueue();\n    const filtered = queue.filter(q => q.message.id !== messageId);\n    await saveMessageQueue(filtered);\n  };\n\n  // Subscribe to new messages only (efficient listener with limitToLast)\n  // Prevents duplicate listeners per chatId\n  const subscribeToNewMessages = (chatId, lastTimestamp, onNewMessage, knownMessageIds) => {\n    // Prevent duplicate listeners for same chatId\n    if (activeListeners.get(chatId)) {\n      return () => {};\n    }\n    const messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${chatId}/messages`);\n\n    // Mark listener as active\n    activeListeners.set(chatId, true);\n\n    // Use limitToLast(30) to reduce data load on weak connections\n    const messagesQuery = (0, _firebaseDatabase.query)(messagesRef, (0, _firebaseDatabase.orderByChild)('timestamp'), (0, _firebaseDatabase.startAt)(lastTimestamp + 1), (0, _firebaseDatabase.limitToLast)(30));\n    (0, _firebaseDatabase.onChildAdded)(messagesQuery, snapshot => {\n      if (snapshot.exists()) {\n        const messageId = snapshot.key || '';\n\n        // Skip if we already have this message (prevent duplicates)\n        if (knownMessageIds.has(messageId)) {\n          return;\n        }\n        const data = snapshot.val();\n        const message = {\n          id: messageId,\n          text: data.text,\n          sender: data.sender,\n          timestamp: data.timestamp,\n          status: 'sent'\n        };\n        onNewMessage(message);\n      }\n    });\n\n    // Return unsubscribe function that cleans up properly\n    return () => {\n      (0, _firebaseDatabase.off)(messagesRef);\n      activeListeners.delete(chatId);\n    };\n  };\n});","lineCount":261,"map":[[12,2,22,0,"Object"],[12,8,22,0],[12,9,22,0,"defineProperty"],[12,23,22,0],[12,24,22,0,"exports"],[12,31,22,0],[13,4,22,0,"enumerable"],[13,14,22,0],[14,4,22,0,"get"],[14,7,22,0],[14,18,22,0,"get"],[14,19,22,0],[15,6,22,0],[15,13,22,0,"generateMessageId"],[15,30,22,0],[16,4,22,0],[17,2,22,0],[18,2,27,0,"Object"],[18,8,27,0],[18,9,27,0,"defineProperty"],[18,23,27,0],[18,24,27,0,"exports"],[18,31,27,0],[19,4,27,0,"enumerable"],[19,14,27,0],[20,4,27,0,"get"],[20,7,27,0],[20,18,27,0,"get"],[20,19,27,0],[21,6,27,0],[21,13,27,0,"getChatId"],[21,22,27,0],[22,4,27,0],[23,2,27,0],[24,2,33,0,"Object"],[24,8,33,0],[24,9,33,0,"defineProperty"],[24,23,33,0],[24,24,33,0,"exports"],[24,31,33,0],[25,4,33,0,"enumerable"],[25,14,33,0],[26,4,33,0,"get"],[26,7,33,0],[26,18,33,0,"get"],[26,19,33,0],[27,6,33,0],[27,13,33,0,"saveMessagesLocally"],[27,32,33,0],[28,4,33,0],[29,2,33,0],[30,2,42,0,"Object"],[30,8,42,0],[30,9,42,0,"defineProperty"],[30,23,42,0],[30,24,42,0,"exports"],[30,31,42,0],[31,4,42,0,"enumerable"],[31,14,42,0],[32,4,42,0,"get"],[32,7,42,0],[32,18,42,0,"get"],[32,19,42,0],[33,6,42,0],[33,13,42,0,"getLocalMessages"],[33,29,42,0],[34,4,42,0],[35,2,42,0],[36,2,52,0,"Object"],[36,8,52,0],[36,9,52,0,"defineProperty"],[36,23,52,0],[36,24,52,0,"exports"],[36,31,52,0],[37,4,52,0,"enumerable"],[37,14,52,0],[38,4,52,0,"get"],[38,7,52,0],[38,18,52,0,"get"],[38,19,52,0],[39,6,52,0],[39,13,52,0,"addMessageLocally"],[39,30,52,0],[40,4,52,0],[41,2,52,0],[42,2,68,0,"Object"],[42,8,68,0],[42,9,68,0,"defineProperty"],[42,23,68,0],[42,24,68,0,"exports"],[42,31,68,0],[43,4,68,0,"enumerable"],[43,14,68,0],[44,4,68,0,"get"],[44,7,68,0],[44,18,68,0,"get"],[44,19,68,0],[45,6,68,0],[45,13,68,0,"updateMessageStatusLocally"],[45,39,68,0],[46,4,68,0],[47,2,68,0],[48,2,86,0,"Object"],[48,8,86,0],[48,9,86,0,"defineProperty"],[48,23,86,0],[48,24,86,0,"exports"],[48,31,86,0],[49,4,86,0,"enumerable"],[49,14,86,0],[50,4,86,0,"get"],[50,7,86,0],[50,18,86,0,"get"],[50,19,86,0],[51,6,86,0],[51,13,86,0,"sendMessageToFirebase"],[51,34,86,0],[52,4,86,0],[53,2,86,0],[54,2,127,0,"Object"],[54,8,127,0],[54,9,127,0,"defineProperty"],[54,23,127,0],[54,24,127,0,"exports"],[54,31,127,0],[55,4,127,0,"enumerable"],[55,14,127,0],[56,4,127,0,"get"],[56,7,127,0],[56,18,127,0,"get"],[56,19,127,0],[57,6,127,0],[57,13,127,0,"getMessageQueue"],[57,28,127,0],[58,4,127,0],[59,2,127,0],[60,2,136,0,"Object"],[60,8,136,0],[60,9,136,0,"defineProperty"],[60,23,136,0],[60,24,136,0,"exports"],[60,31,136,0],[61,4,136,0,"enumerable"],[61,14,136,0],[62,4,136,0,"get"],[62,7,136,0],[62,18,136,0,"get"],[62,19,136,0],[63,6,136,0],[63,13,136,0,"saveMessageQueue"],[63,29,136,0],[64,4,136,0],[65,2,136,0],[66,2,144,0,"Object"],[66,8,144,0],[66,9,144,0,"defineProperty"],[66,23,144,0],[66,24,144,0,"exports"],[66,31,144,0],[67,4,144,0,"enumerable"],[67,14,144,0],[68,4,144,0,"get"],[68,7,144,0],[68,18,144,0,"get"],[68,19,144,0],[69,6,144,0],[69,13,144,0,"addToQueue"],[69,23,144,0],[70,4,144,0],[71,2,144,0],[72,2,154,0,"Object"],[72,8,154,0],[72,9,154,0,"defineProperty"],[72,23,154,0],[72,24,154,0,"exports"],[72,31,154,0],[73,4,154,0,"enumerable"],[73,14,154,0],[74,4,154,0,"get"],[74,7,154,0],[74,18,154,0,"get"],[74,19,154,0],[75,6,154,0],[75,13,154,0,"removeFromQueue"],[75,28,154,0],[76,4,154,0],[77,2,154,0],[78,2,162,0,"Object"],[78,8,162,0],[78,9,162,0,"defineProperty"],[78,23,162,0],[78,24,162,0,"exports"],[78,31,162,0],[79,4,162,0,"enumerable"],[79,14,162,0],[80,4,162,0,"get"],[80,7,162,0],[80,18,162,0,"get"],[80,19,162,0],[81,6,162,0],[81,13,162,0,"subscribeToNewMessages"],[81,35,162,0],[82,4,162,0],[83,2,162,0],[84,2,1,0],[84,6,1,0,"_firebaseDatabase"],[84,23,1,0],[84,26,1,0,"require"],[84,33,1,0],[84,34,1,0,"_dependencyMap"],[84,48,1,0],[85,2,2,0],[85,6,2,0,"_configFirebase"],[85,21,2,0],[85,24,2,0,"require"],[85,31,2,0],[85,32,2,0,"_dependencyMap"],[85,46,2,0],[86,2,3,0],[86,6,3,0,"_reactNativeAsyncStorageAsyncStorage"],[86,42,3,0],[86,45,3,0,"require"],[86,52,3,0],[86,53,3,0,"_dependencyMap"],[86,67,3,0],[87,2,3,0],[87,6,3,0,"AsyncStorage"],[87,18,3,0],[87,21,3,0,"_interopDefault"],[87,36,3,0],[87,37,3,0,"_reactNativeAsyncStorageAsyncStorage"],[87,73,3,0],[88,2,15,0],[88,8,15,6,"QUEUE_KEY"],[88,17,15,15],[88,20,15,18],[88,42,15,40],[89,2,16,0],[89,8,16,6,"MESSAGES_KEY"],[89,20,16,18],[89,23,16,21],[89,41,16,39],[91,2,18,0],[92,2,19,0],[92,8,19,6,"activeListeners"],[92,23,19,21],[92,26,19,24],[92,30,19,28,"Map"],[92,33,19,31],[92,34,19,49],[92,35,19,50],[94,2,21,0],[95,2,22,7],[95,8,22,13,"generateMessageId"],[95,25,22,30],[95,28,22,33,"generateMessageId"],[95,29,22,33],[95,34,22,47],[96,4,23,2],[96,11,23,9],[96,14,23,12,"Date"],[96,18,23,16],[96,19,23,17,"now"],[96,22,23,20],[96,23,23,21],[96,24,23,22],[96,28,23,26,"Math"],[96,32,23,30],[96,33,23,31,"random"],[96,39,23,37],[96,40,23,38],[96,41,23,39],[96,42,23,40,"toString"],[96,50,23,48],[96,51,23,49],[96,53,23,51],[96,54,23,52],[96,55,23,53,"substr"],[96,61,23,59],[96,62,23,60],[96,63,23,61],[96,65,23,63],[96,66,23,64],[96,67,23,65],[96,69,23,67],[97,2,24,0],[97,3,24,1],[99,2,26,0],[100,2,27,7],[100,8,27,13,"getChatId"],[100,17,27,22],[100,20,27,25,"getChatId"],[100,21,27,26,"phone1"],[100,27,27,40],[100,29,27,42,"phone2"],[100,35,27,56],[100,40,27,69],[101,4,28,2],[101,10,28,8,"sorted"],[101,16,28,14],[101,19,28,17],[101,20,28,18,"phone1"],[101,26,28,24],[101,28,28,26,"phone2"],[101,34,28,32],[101,35,28,33],[101,36,28,34,"sort"],[101,40,28,38],[101,41,28,39],[101,42,28,40],[102,4,29,2],[102,11,29,9],[102,14,29,12,"sorted"],[102,20,29,18],[102,21,29,19],[102,22,29,20],[102,23,29,21],[102,27,29,25,"sorted"],[102,33,29,31],[102,34,29,32],[102,35,29,33],[102,36,29,34],[102,38,29,36],[103,2,30,0],[103,3,30,1],[105,2,32,0],[106,2,33,7],[106,8,33,13,"saveMessagesLocally"],[106,27,33,32],[106,30,33,35],[106,36,33,35,"saveMessagesLocally"],[106,37,33,42,"chatId"],[106,43,33,56],[106,45,33,58,"messages"],[106,53,33,77],[106,58,33,97],[107,4,34,2],[107,8,34,6],[108,6,35,4],[108,12,35,10,"AsyncStorage"],[108,24,35,22],[108,25,35,22,"default"],[108,32,35,22],[108,33,35,23,"setItem"],[108,40,35,30],[108,41,35,31,"MESSAGES_KEY"],[108,53,35,43],[108,56,35,46,"chatId"],[108,62,35,52],[108,64,35,54,"JSON"],[108,68,35,58],[108,69,35,59,"stringify"],[108,78,35,68],[108,79,35,69,"messages"],[108,87,35,77],[108,88,35,78],[108,89,35,79],[109,4,36,2],[109,5,36,3],[109,6,36,4],[109,13,36,11,"e"],[109,14,36,12],[109,16,36,14],[110,6,37,4],[111,4,37,4],[112,2,39,0],[112,3,39,1],[114,2,41,0],[115,2,42,7],[115,8,42,13,"getLocalMessages"],[115,24,42,29],[115,27,42,32],[115,33,42,39,"chatId"],[115,39,42,53],[115,43,42,78],[116,4,43,2],[116,8,43,6],[117,6,44,4],[117,12,44,10,"data"],[117,16,44,14],[117,19,44,17],[117,25,44,23,"AsyncStorage"],[117,37,44,35],[117,38,44,35,"default"],[117,45,44,35],[117,46,44,36,"getItem"],[117,53,44,43],[117,54,44,44,"MESSAGES_KEY"],[117,66,44,56],[117,69,44,59,"chatId"],[117,75,44,65],[117,76,44,66],[118,6,45,4],[118,13,45,11,"data"],[118,17,45,15],[118,20,45,18,"JSON"],[118,24,45,22],[118,25,45,23,"parse"],[118,30,45,28],[118,31,45,29,"data"],[118,35,45,33],[118,36,45,34],[118,39,45,37],[118,41,45,39],[119,4,46,2],[119,5,46,3],[119,6,46,4],[119,13,46,11,"e"],[119,14,46,12],[119,16,46,14],[120,6,47,4],[120,13,47,11],[120,15,47,13],[121,4,48,2],[122,2,49,0],[122,3,49,1],[124,2,51,0],[125,2,52,7],[125,8,52,13,"addMessageLocally"],[125,25,52,30],[125,28,52,33],[125,34,52,33,"addMessageLocally"],[125,35,52,40,"chatId"],[125,41,52,54],[125,43,52,56,"message"],[125,50,52,72],[125,55,52,92],[126,4,53,2],[126,8,53,6],[127,6,54,4],[127,12,54,10,"messages"],[127,20,54,18],[127,23,54,21],[127,29,54,27,"getLocalMessages"],[127,45,54,43],[127,46,54,44,"chatId"],[127,52,54,50],[127,53,54,51],[128,6,55,4],[128,12,55,10,"exists"],[128,18,55,16],[128,21,55,19,"messages"],[128,29,55,27],[128,30,55,28,"find"],[128,34,55,32],[128,35,55,33,"m"],[128,36,55,34],[128,40,55,38,"m"],[128,41,55,39],[128,42,55,40,"id"],[128,44,55,42],[128,49,55,47,"message"],[128,56,55,54],[128,57,55,55,"id"],[128,59,55,57],[128,60,55,58],[129,6,56,4],[129,10,56,8],[129,11,56,9,"exists"],[129,17,56,15],[129,19,56,17],[130,8,57,6,"messages"],[130,16,57,14],[130,17,57,15,"push"],[130,21,57,19],[130,22,57,20,"message"],[130,29,57,27],[130,30,57,28],[131,8,58,6],[132,8,59,6],[132,14,59,12,"trimmed"],[132,21,59,19],[132,24,59,22,"messages"],[132,32,59,30],[132,33,59,31,"slice"],[132,38,59,36],[132,39,59,37],[132,40,59,38],[132,43,59,41],[132,44,59,42],[133,8,60,6],[133,14,60,12,"saveMessagesLocally"],[133,33,60,31],[133,34,60,32,"chatId"],[133,40,60,38],[133,42,60,40,"trimmed"],[133,49,60,47],[133,50,60,48],[134,6,61,4],[135,4,62,2],[135,5,62,3],[135,6,62,4],[135,13,62,11,"e"],[135,14,62,12],[135,16,62,14],[136,6,63,4],[137,4,63,4],[138,2,65,0],[138,3,65,1],[140,2,67,0],[141,2,68,7],[141,8,68,13,"updateMessageStatusLocally"],[141,34,68,39],[141,37,68,42],[141,43,68,42,"updateMessageStatusLocally"],[141,44,69,2,"chatId"],[141,50,69,16],[141,52,70,2,"messageId"],[141,61,70,19],[141,63,71,2,"status"],[141,69,71,23],[141,74,72,20],[142,4,73,2],[142,8,73,6],[143,6,74,4],[143,12,74,10,"messages"],[143,20,74,18],[143,23,74,21],[143,29,74,27,"getLocalMessages"],[143,45,74,43],[143,46,74,44,"chatId"],[143,52,74,50],[143,53,74,51],[144,6,75,4],[144,12,75,10,"index"],[144,17,75,15],[144,20,75,18,"messages"],[144,28,75,26],[144,29,75,27,"findIndex"],[144,38,75,36],[144,39,75,37,"m"],[144,40,75,38],[144,44,75,42,"m"],[144,45,75,43],[144,46,75,44,"id"],[144,48,75,46],[144,53,75,51,"messageId"],[144,62,75,60],[144,63,75,61],[145,6,76,4],[145,10,76,8,"index"],[145,15,76,13],[145,20,76,18],[145,21,76,19],[145,22,76,20],[145,24,76,22],[146,8,77,6,"messages"],[146,16,77,14],[146,17,77,15,"index"],[146,22,77,20],[146,23,77,21],[146,24,77,22,"status"],[146,30,77,28],[146,33,77,31,"status"],[146,39,77,37],[147,8,78,6],[147,14,78,12,"saveMessagesLocally"],[147,33,78,31],[147,34,78,32,"chatId"],[147,40,78,38],[147,42,78,40,"messages"],[147,50,78,48],[147,51,78,49],[148,6,79,4],[149,4,80,2],[149,5,80,3],[149,6,80,4],[149,13,80,11,"e"],[149,14,80,12],[149,16,80,14],[150,6,81,4],[151,4,81,4],[152,2,83,0],[152,3,83,1],[154,2,85,0],[155,2,86,7],[155,8,86,13,"sendMessageToFirebase"],[155,29,86,34],[155,32,86,37],[155,38,86,37,"sendMessageToFirebase"],[155,39,87,2,"chatId"],[155,45,87,16],[155,47,88,2,"message"],[155,54,88,18],[155,59,89,23],[156,4,90,2],[156,8,90,6],[157,6,91,4],[157,12,91,10,"messageRef"],[157,22,91,20],[157,25,91,23],[157,29,91,23,"ref"],[157,46,91,26],[157,47,91,26,"ref"],[157,50,91,26],[157,52,91,27,"database"],[157,67,91,35],[157,68,91,35,"database"],[157,76,91,35],[157,78,91,37],[157,87,91,46,"chatId"],[157,93,91,52],[157,106,91,65,"message"],[157,113,91,72],[157,114,91,73,"id"],[157,116,91,75],[157,118,91,77],[157,119,91,78],[159,6,93,4],[160,6,94,4],[160,12,94,10,"snapshot"],[160,20,94,18],[160,23,94,21],[160,29,94,27],[160,33,94,27,"get"],[160,50,94,30],[160,51,94,30,"get"],[160,54,94,30],[160,56,94,31,"messageRef"],[160,66,94,41],[160,67,94,42],[161,6,95,4],[161,10,95,8,"snapshot"],[161,18,95,16],[161,19,95,17,"exists"],[161,25,95,23],[161,26,95,24],[161,27,95,25],[161,29,95,27],[162,8,96,6],[162,15,96,13],[162,19,96,17],[163,6,97,4],[165,6,99,4],[166,6,100,4],[166,12,100,10],[166,16,100,10,"set"],[166,33,100,13],[166,34,100,13,"set"],[166,37,100,13],[166,39,100,14,"messageRef"],[166,49,100,24],[166,51,100,26],[167,8,101,6,"text"],[167,12,101,10],[167,14,101,12,"message"],[167,21,101,19],[167,22,101,20,"text"],[167,26,101,24],[168,8,102,6,"sender"],[168,14,102,12],[168,16,102,14,"message"],[168,23,102,21],[168,24,102,22,"sender"],[168,30,102,28],[169,8,103,6,"timestamp"],[169,17,103,15],[169,19,103,17,"message"],[169,26,103,24],[169,27,103,25,"timestamp"],[169,36,103,34],[170,8,104,6,"status"],[170,14,104,12],[170,16,104,14],[171,6,105,4],[171,7,105,5],[171,8,105,6],[173,6,107,4],[174,6,108,4],[174,12,108,10,"metaRef"],[174,19,108,17],[174,22,108,20],[174,26,108,20,"ref"],[174,43,108,23],[174,44,108,23,"ref"],[174,47,108,23],[174,49,108,24,"database"],[174,64,108,32],[174,65,108,32,"database"],[174,73,108,32],[174,75,108,34],[174,84,108,43,"chatId"],[174,90,108,49],[174,97,108,56],[174,98,108,57],[175,6,109,4],[175,12,109,10],[175,16,109,10,"set"],[175,33,109,13],[175,34,109,13,"set"],[175,37,109,13],[175,39,109,14,"metaRef"],[175,46,109,21],[175,48,109,23],[176,8,110,6,"lastMessage"],[176,19,110,17],[176,21,110,19,"message"],[176,28,110,26],[176,29,110,27,"text"],[176,33,110,31],[176,34,110,32,"substring"],[176,43,110,41],[176,44,110,42],[176,45,110,43],[176,47,110,45],[176,49,110,47],[176,50,110,48],[177,8,111,6,"lastTimestamp"],[177,21,111,19],[177,23,111,21,"message"],[177,30,111,28],[177,31,111,29,"timestamp"],[178,6,112,4],[178,7,112,5],[178,8,112,6],[179,6,114,4],[179,13,114,11],[179,17,114,15],[180,4,115,2],[180,5,115,3],[180,6,115,4],[180,13,115,11,"e"],[180,14,115,12],[180,16,115,14],[181,6,116,4],[181,13,116,11],[181,18,116,16],[182,4,117,2],[183,2,118,0],[183,3,118,1],[185,2,120,0],[187,2,127,7],[187,8,127,13,"getMessageQueue"],[187,23,127,28],[187,26,127,31],[187,32,127,31,"getMessageQueue"],[187,33,127,31],[187,38,127,69],[188,4,128,2],[188,8,128,6],[189,6,129,4],[189,12,129,10,"data"],[189,16,129,14],[189,19,129,17],[189,25,129,23,"AsyncStorage"],[189,37,129,35],[189,38,129,35,"default"],[189,45,129,35],[189,46,129,36,"getItem"],[189,53,129,43],[189,54,129,44,"QUEUE_KEY"],[189,63,129,53],[189,64,129,54],[190,6,130,4],[190,13,130,11,"data"],[190,17,130,15],[190,20,130,18,"JSON"],[190,24,130,22],[190,25,130,23,"parse"],[190,30,130,28],[190,31,130,29,"data"],[190,35,130,33],[190,36,130,34],[190,39,130,37],[190,41,130,39],[191,4,131,2],[191,5,131,3],[191,6,131,4],[191,13,131,11,"e"],[191,14,131,12],[191,16,131,14],[192,6,132,4],[192,13,132,11],[192,15,132,13],[193,4,133,2],[194,2,134,0],[194,3,134,1],[195,2,136,7],[195,8,136,13,"saveMessageQueue"],[195,24,136,29],[195,27,136,32],[195,33,136,39,"queue"],[195,38,136,61],[195,42,136,81],[196,4,137,2],[196,8,137,6],[197,6,138,4],[197,12,138,10,"AsyncStorage"],[197,24,138,22],[197,25,138,22,"default"],[197,32,138,22],[197,33,138,23,"setItem"],[197,40,138,30],[197,41,138,31,"QUEUE_KEY"],[197,50,138,40],[197,52,138,42,"JSON"],[197,56,138,46],[197,57,138,47,"stringify"],[197,66,138,56],[197,67,138,57,"queue"],[197,72,138,62],[197,73,138,63],[197,74,138,64],[198,4,139,2],[198,5,139,3],[198,6,139,4],[198,13,139,11,"e"],[198,14,139,12],[198,16,139,14],[199,6,140,4],[200,4,140,4],[201,2,142,0],[201,3,142,1],[202,2,144,7],[202,8,144,13,"addToQueue"],[202,18,144,23],[202,21,144,26],[202,27,144,26,"addToQueue"],[202,28,144,33,"chatId"],[202,34,144,47],[202,36,144,49,"message"],[202,43,144,65],[202,48,144,85],[203,4,145,2],[203,10,145,8,"queue"],[203,15,145,13],[203,18,145,16],[203,24,145,22,"getMessageQueue"],[203,39,145,37],[203,40,145,38],[203,41,145,39],[204,4,146,2],[205,4,147,2],[205,10,147,8,"exists"],[205,16,147,14],[205,19,147,17,"queue"],[205,24,147,22],[205,25,147,23,"find"],[205,29,147,27],[205,30,147,28,"q"],[205,31,147,29],[205,35,147,33,"q"],[205,36,147,34],[205,37,147,35,"message"],[205,44,147,42],[205,45,147,43,"id"],[205,47,147,45],[205,52,147,50,"message"],[205,59,147,57],[205,60,147,58,"id"],[205,62,147,60],[205,63,147,61],[206,4,148,2],[206,8,148,6],[206,9,148,7,"exists"],[206,15,148,13],[206,17,148,15],[207,6,149,4,"queue"],[207,11,149,9],[207,12,149,10,"push"],[207,16,149,14],[207,17,149,15],[208,8,149,17,"chatId"],[208,14,149,23],[209,8,149,25,"message"],[209,15,149,32],[210,8,149,34,"retryCount"],[210,18,149,44],[210,20,149,46],[211,6,149,48],[211,7,149,49],[211,8,149,50],[212,6,150,4],[212,12,150,10,"saveMessageQueue"],[212,28,150,26],[212,29,150,27,"queue"],[212,34,150,32],[212,35,150,33],[213,4,151,2],[214,2,152,0],[214,3,152,1],[215,2,154,7],[215,8,154,13,"removeFromQueue"],[215,23,154,28],[215,26,154,31],[215,32,154,38,"messageId"],[215,41,154,55],[215,45,154,75],[216,4,155,2],[216,10,155,8,"queue"],[216,15,155,13],[216,18,155,16],[216,24,155,22,"getMessageQueue"],[216,39,155,37],[216,40,155,38],[216,41,155,39],[217,4,156,2],[217,10,156,8,"filtered"],[217,18,156,16],[217,21,156,19,"queue"],[217,26,156,24],[217,27,156,25,"filter"],[217,33,156,31],[217,34,156,32,"q"],[217,35,156,33],[217,39,156,37,"q"],[217,40,156,38],[217,41,156,39,"message"],[217,48,156,46],[217,49,156,47,"id"],[217,51,156,49],[217,56,156,54,"messageId"],[217,65,156,63],[217,66,156,64],[218,4,157,2],[218,10,157,8,"saveMessageQueue"],[218,26,157,24],[218,27,157,25,"filtered"],[218,35,157,33],[218,36,157,34],[219,2,158,0],[219,3,158,1],[221,2,160,0],[222,2,161,0],[223,2,162,7],[223,8,162,13,"subscribeToNewMessages"],[223,30,162,35],[223,33,162,38,"subscribeToNewMessages"],[223,34,163,2,"chatId"],[223,40,163,16],[223,42,164,2,"lastTimestamp"],[223,55,164,23],[223,57,165,2,"onNewMessage"],[223,69,165,42],[223,71,166,2,"knownMessageIds"],[223,86,166,30],[223,91,167,19],[224,4,168,2],[225,4,169,2],[225,8,169,6,"activeListeners"],[225,23,169,21],[225,24,169,22,"get"],[225,27,169,25],[225,28,169,26,"chatId"],[225,34,169,32],[225,35,169,33],[225,37,169,35],[226,6,170,4],[226,13,170,11],[226,19,170,17],[226,20,170,18],[226,21,170,19],[227,4,171,2],[228,4,173,2],[228,10,173,8,"messagesRef"],[228,21,173,19],[228,24,173,22],[228,28,173,22,"ref"],[228,45,173,25],[228,46,173,25,"ref"],[228,49,173,25],[228,51,173,26,"database"],[228,66,173,34],[228,67,173,34,"database"],[228,75,173,34],[228,77,173,36],[228,86,173,45,"chatId"],[228,92,173,51],[228,103,173,62],[228,104,173,63],[230,4,175,2],[231,4,176,2,"activeListeners"],[231,19,176,17],[231,20,176,18,"set"],[231,23,176,21],[231,24,176,22,"chatId"],[231,30,176,28],[231,32,176,30],[231,36,176,34],[231,37,176,35],[233,4,178,2],[234,4,179,2],[234,10,179,8,"messagesQuery"],[234,23,179,21],[234,26,179,24],[234,30,179,24,"query"],[234,47,179,29],[234,48,179,29,"query"],[234,53,179,29],[234,55,180,4,"messagesRef"],[234,66,180,15],[234,68,181,4],[234,72,181,4,"orderByChild"],[234,89,181,16],[234,90,181,16,"orderByChild"],[234,102,181,16],[234,104,181,17],[234,115,181,28],[234,116,181,29],[234,118,182,4],[234,122,182,4,"startAt"],[234,139,182,11],[234,140,182,11,"startAt"],[234,147,182,11],[234,149,182,12,"lastTimestamp"],[234,162,182,25],[234,165,182,28],[234,166,182,29],[234,167,182,30],[234,169,183,4],[234,173,183,4,"limitToLast"],[234,190,183,15],[234,191,183,15,"limitToLast"],[234,202,183,15],[234,204,183,16],[234,206,183,18],[234,207,184,2],[234,208,184,3],[235,4,186,2],[235,8,186,2,"onChildAdded"],[235,25,186,14],[235,26,186,14,"onChildAdded"],[235,38,186,14],[235,40,186,15,"messagesQuery"],[235,53,186,28],[235,55,186,31,"snapshot"],[235,63,186,39],[235,67,186,44],[236,6,187,4],[236,10,187,8,"snapshot"],[236,18,187,16],[236,19,187,17,"exists"],[236,25,187,23],[236,26,187,24],[236,27,187,25],[236,29,187,27],[237,8,188,6],[237,14,188,12,"messageId"],[237,23,188,21],[237,26,188,24,"snapshot"],[237,34,188,32],[237,35,188,33,"key"],[237,38,188,36],[237,42,188,40],[237,44,188,42],[239,8,190,6],[240,8,191,6],[240,12,191,10,"knownMessageIds"],[240,27,191,25],[240,28,191,26,"has"],[240,31,191,29],[240,32,191,30,"messageId"],[240,41,191,39],[240,42,191,40],[240,44,191,42],[241,10,192,8],[242,8,193,6],[243,8,195,6],[243,14,195,12,"data"],[243,18,195,16],[243,21,195,19,"snapshot"],[243,29,195,27],[243,30,195,28,"val"],[243,33,195,31],[243,34,195,32],[243,35,195,33],[244,8,196,6],[244,14,196,12,"message"],[244,21,196,28],[244,24,196,31],[245,10,197,8,"id"],[245,12,197,10],[245,14,197,12,"messageId"],[245,23,197,21],[246,10,198,8,"text"],[246,14,198,12],[246,16,198,14,"data"],[246,20,198,18],[246,21,198,19,"text"],[246,25,198,23],[247,10,199,8,"sender"],[247,16,199,14],[247,18,199,16,"data"],[247,22,199,20],[247,23,199,21,"sender"],[247,29,199,27],[248,10,200,8,"timestamp"],[248,19,200,17],[248,21,200,19,"data"],[248,25,200,23],[248,26,200,24,"timestamp"],[248,35,200,33],[249,10,201,8,"status"],[249,16,201,14],[249,18,201,16],[250,8,202,6],[250,9,202,7],[251,8,203,6,"onNewMessage"],[251,20,203,18],[251,21,203,19,"message"],[251,28,203,26],[251,29,203,27],[252,6,204,4],[253,4,205,2],[253,5,205,3],[253,6,205,4],[255,4,207,2],[256,4,208,2],[256,11,208,9],[256,17,208,15],[257,6,209,4],[257,10,209,4,"off"],[257,27,209,7],[257,28,209,7,"off"],[257,31,209,7],[257,33,209,8,"messagesRef"],[257,44,209,19],[257,45,209,20],[258,6,210,4,"activeListeners"],[258,21,210,19],[258,22,210,20,"delete"],[258,28,210,26],[258,29,210,27,"chatId"],[258,35,210,33],[258,36,210,34],[259,4,211,2],[259,5,211,3],[260,2,212,0],[260,3,212,1],[261,0,212,2],[261,3]],"functionMap":{"names":["<global>","generateMessageId","getChatId","saveMessagesLocally","getLocalMessages","addMessageLocally","messages.find$argument_0","updateMessageStatusLocally","messages.findIndex$argument_0","sendMessageToFirebase","getMessageQueue","saveMessageQueue","addToQueue","queue.find$argument_0","removeFromQueue","queue.filter$argument_0","subscribeToNewMessages","<anonymous>","onChildAdded$argument_1"],"mappings":"AAA;iCCqB;CDE;yBEG;CFG;mCGG;CHM;gCIG;CJO;iCKG;iCCG,wBD;CLU;0COG;qCCO,uBD;CPQ;qCSG;CTgC;+BUS;CVO;gCWE;CXM;0BYE;4BCG,gCD;CZK;+BcE;gCCE,+BD;CdE;sCgBI;WCQ,QD;8BEgB;GFmB;SCG;GDG;ChBC"},"hasCjsExports":false},"type":"js/module"}]}