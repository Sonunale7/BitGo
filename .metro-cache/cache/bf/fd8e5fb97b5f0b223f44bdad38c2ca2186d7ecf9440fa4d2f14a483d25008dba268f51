{"dependencies":[{"name":"firebase/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":117,"index":117}}],"key":"ZF/J3nfk5GUgbzXl84BqV1IxYEE=","exportNames":["*"],"imports":1}},{"name":"../config/firebase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":118},"end":{"line":2,"column":46,"index":164}}],"key":"K/SZPG5sPeV1upVh8dao26aG7MQ=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":165},"end":{"line":3,"column":69,"index":234}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"generateMessageId\", {\n    enumerable: true,\n    get: function () {\n      return generateMessageId;\n    }\n  });\n  Object.defineProperty(exports, \"getChatId\", {\n    enumerable: true,\n    get: function () {\n      return getChatId;\n    }\n  });\n  Object.defineProperty(exports, \"saveMessagesLocally\", {\n    enumerable: true,\n    get: function () {\n      return saveMessagesLocally;\n    }\n  });\n  Object.defineProperty(exports, \"getLocalMessages\", {\n    enumerable: true,\n    get: function () {\n      return getLocalMessages;\n    }\n  });\n  Object.defineProperty(exports, \"addMessageLocally\", {\n    enumerable: true,\n    get: function () {\n      return addMessageLocally;\n    }\n  });\n  Object.defineProperty(exports, \"updateMessageStatusLocally\", {\n    enumerable: true,\n    get: function () {\n      return updateMessageStatusLocally;\n    }\n  });\n  Object.defineProperty(exports, \"sendMessageToFirebase\", {\n    enumerable: true,\n    get: function () {\n      return sendMessageToFirebase;\n    }\n  });\n  Object.defineProperty(exports, \"getMessageQueue\", {\n    enumerable: true,\n    get: function () {\n      return getMessageQueue;\n    }\n  });\n  Object.defineProperty(exports, \"saveMessageQueue\", {\n    enumerable: true,\n    get: function () {\n      return saveMessageQueue;\n    }\n  });\n  Object.defineProperty(exports, \"addToQueue\", {\n    enumerable: true,\n    get: function () {\n      return addToQueue;\n    }\n  });\n  Object.defineProperty(exports, \"removeFromQueue\", {\n    enumerable: true,\n    get: function () {\n      return removeFromQueue;\n    }\n  });\n  Object.defineProperty(exports, \"subscribeToNewMessages\", {\n    enumerable: true,\n    get: function () {\n      return subscribeToNewMessages;\n    }\n  });\n  var _firebaseDatabase = require(_dependencyMap[0], \"firebase/database\");\n  var _configFirebase = require(_dependencyMap[1], \"../config/firebase\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[2], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const QUEUE_KEY = '@bitgo_message_queue';\n  const MESSAGES_KEY = '@bitgo_messages_';\n\n  // Generate unique message ID locally\n  const generateMessageId = () => {\n    return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  };\n\n  // Get chat ID from two user phones (sorted for consistency)\n  const getChatId = (phone1, phone2) => {\n    const sorted = [phone1, phone2].sort();\n    return `${sorted[0]}_${sorted[1]}`;\n  };\n\n  // Save messages locally for a chat\n  const saveMessagesLocally = async (chatId, messages) => {\n    try {\n      await AsyncStorage.default.setItem(MESSAGES_KEY + chatId, JSON.stringify(messages));\n    } catch (e) {\n      console.log('Error saving messages locally:', e);\n    }\n  };\n\n  // Get messages from local storage\n  const getLocalMessages = async chatId => {\n    try {\n      const data = await AsyncStorage.default.getItem(MESSAGES_KEY + chatId);\n      return data ? JSON.parse(data) : [];\n    } catch (e) {\n      console.log('Error getting local messages:', e);\n      return [];\n    }\n  };\n\n  // Add single message to local storage\n  const addMessageLocally = async (chatId, message) => {\n    try {\n      const messages = await getLocalMessages(chatId);\n      const exists = messages.find(m => m.id === message.id);\n      if (!exists) {\n        messages.push(message);\n        // Keep only last 100 messages locally\n        const trimmed = messages.slice(-100);\n        await saveMessagesLocally(chatId, trimmed);\n      }\n    } catch (e) {\n      console.log('Error adding message locally:', e);\n    }\n  };\n\n  // Update message status locally\n  const updateMessageStatusLocally = async (chatId, messageId, status) => {\n    try {\n      const messages = await getLocalMessages(chatId);\n      const index = messages.findIndex(m => m.id === messageId);\n      if (index !== -1) {\n        messages[index].status = status;\n        await saveMessagesLocally(chatId, messages);\n      }\n    } catch (e) {\n      console.log('Error updating message status:', e);\n    }\n  };\n\n  // Send message to Firebase (minimal payload)\n  const sendMessageToFirebase = async (chatId, message) => {\n    try {\n      const messageRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${chatId}/messages/${message.id}`);\n      await (0, _firebaseDatabase.set)(messageRef, {\n        text: message.text,\n        sender: message.sender,\n        timestamp: message.timestamp,\n        status: 'sent'\n      });\n      return true;\n    } catch (e) {\n      console.log('Firebase send error:', e);\n      return false;\n    }\n  };\n\n  // Queue management for offline messages\n\n  const getMessageQueue = async () => {\n    try {\n      const data = await AsyncStorage.default.getItem(QUEUE_KEY);\n      return data ? JSON.parse(data) : [];\n    } catch (e) {\n      console.log('Error getting queue:', e);\n      return [];\n    }\n  };\n  const saveMessageQueue = async queue => {\n    try {\n      await AsyncStorage.default.setItem(QUEUE_KEY, JSON.stringify(queue));\n    } catch (e) {\n      console.log('Error saving queue:', e);\n    }\n  };\n  const addToQueue = async (chatId, message) => {\n    const queue = await getMessageQueue();\n    // Check if already in queue\n    const exists = queue.find(q => q.message.id === message.id);\n    if (!exists) {\n      queue.push({\n        chatId,\n        message,\n        retryCount: 0\n      });\n      await saveMessageQueue(queue);\n    }\n  };\n  const removeFromQueue = async messageId => {\n    const queue = await getMessageQueue();\n    const filtered = queue.filter(q => q.message.id !== messageId);\n    await saveMessageQueue(filtered);\n  };\n\n  // Subscribe to new messages only (efficient listener)\n  const subscribeToNewMessages = (chatId, lastTimestamp, onNewMessage) => {\n    const messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${chatId}/messages`);\n    const messagesQuery = (0, _firebaseDatabase.query)(messagesRef, (0, _firebaseDatabase.orderByChild)('timestamp'), (0, _firebaseDatabase.startAt)(lastTimestamp + 1));\n    const callback = (0, _firebaseDatabase.onChildAdded)(messagesQuery, snapshot => {\n      if (snapshot.exists()) {\n        const data = snapshot.val();\n        const message = {\n          id: snapshot.key || generateMessageId(),\n          text: data.text,\n          sender: data.sender,\n          timestamp: data.timestamp,\n          status: 'sent'\n        };\n        onNewMessage(message);\n      }\n    });\n\n    // Return unsubscribe function\n    return () => {\n      (0, _firebaseDatabase.off)(messagesRef);\n    };\n  };\n});","lineCount":229,"map":[[12,2,19,0,"Object"],[12,8,19,0],[12,9,19,0,"defineProperty"],[12,23,19,0],[12,24,19,0,"exports"],[12,31,19,0],[13,4,19,0,"enumerable"],[13,14,19,0],[14,4,19,0,"get"],[14,7,19,0],[14,18,19,0,"get"],[14,19,19,0],[15,6,19,0],[15,13,19,0,"generateMessageId"],[15,30,19,0],[16,4,19,0],[17,2,19,0],[18,2,24,0,"Object"],[18,8,24,0],[18,9,24,0,"defineProperty"],[18,23,24,0],[18,24,24,0,"exports"],[18,31,24,0],[19,4,24,0,"enumerable"],[19,14,24,0],[20,4,24,0,"get"],[20,7,24,0],[20,18,24,0,"get"],[20,19,24,0],[21,6,24,0],[21,13,24,0,"getChatId"],[21,22,24,0],[22,4,24,0],[23,2,24,0],[24,2,30,0,"Object"],[24,8,30,0],[24,9,30,0,"defineProperty"],[24,23,30,0],[24,24,30,0,"exports"],[24,31,30,0],[25,4,30,0,"enumerable"],[25,14,30,0],[26,4,30,0,"get"],[26,7,30,0],[26,18,30,0,"get"],[26,19,30,0],[27,6,30,0],[27,13,30,0,"saveMessagesLocally"],[27,32,30,0],[28,4,30,0],[29,2,30,0],[30,2,39,0,"Object"],[30,8,39,0],[30,9,39,0,"defineProperty"],[30,23,39,0],[30,24,39,0,"exports"],[30,31,39,0],[31,4,39,0,"enumerable"],[31,14,39,0],[32,4,39,0,"get"],[32,7,39,0],[32,18,39,0,"get"],[32,19,39,0],[33,6,39,0],[33,13,39,0,"getLocalMessages"],[33,29,39,0],[34,4,39,0],[35,2,39,0],[36,2,50,0,"Object"],[36,8,50,0],[36,9,50,0,"defineProperty"],[36,23,50,0],[36,24,50,0,"exports"],[36,31,50,0],[37,4,50,0,"enumerable"],[37,14,50,0],[38,4,50,0,"get"],[38,7,50,0],[38,18,50,0,"get"],[38,19,50,0],[39,6,50,0],[39,13,50,0,"addMessageLocally"],[39,30,50,0],[40,4,50,0],[41,2,50,0],[42,2,66,0,"Object"],[42,8,66,0],[42,9,66,0,"defineProperty"],[42,23,66,0],[42,24,66,0,"exports"],[42,31,66,0],[43,4,66,0,"enumerable"],[43,14,66,0],[44,4,66,0,"get"],[44,7,66,0],[44,18,66,0,"get"],[44,19,66,0],[45,6,66,0],[45,13,66,0,"updateMessageStatusLocally"],[45,39,66,0],[46,4,66,0],[47,2,66,0],[48,2,84,0,"Object"],[48,8,84,0],[48,9,84,0,"defineProperty"],[48,23,84,0],[48,24,84,0,"exports"],[48,31,84,0],[49,4,84,0,"enumerable"],[49,14,84,0],[50,4,84,0,"get"],[50,7,84,0],[50,18,84,0,"get"],[50,19,84,0],[51,6,84,0],[51,13,84,0,"sendMessageToFirebase"],[51,34,84,0],[52,4,84,0],[53,2,84,0],[54,2,110,0,"Object"],[54,8,110,0],[54,9,110,0,"defineProperty"],[54,23,110,0],[54,24,110,0,"exports"],[54,31,110,0],[55,4,110,0,"enumerable"],[55,14,110,0],[56,4,110,0,"get"],[56,7,110,0],[56,18,110,0,"get"],[56,19,110,0],[57,6,110,0],[57,13,110,0,"getMessageQueue"],[57,28,110,0],[58,4,110,0],[59,2,110,0],[60,2,120,0,"Object"],[60,8,120,0],[60,9,120,0,"defineProperty"],[60,23,120,0],[60,24,120,0,"exports"],[60,31,120,0],[61,4,120,0,"enumerable"],[61,14,120,0],[62,4,120,0,"get"],[62,7,120,0],[62,18,120,0,"get"],[62,19,120,0],[63,6,120,0],[63,13,120,0,"saveMessageQueue"],[63,29,120,0],[64,4,120,0],[65,2,120,0],[66,2,128,0,"Object"],[66,8,128,0],[66,9,128,0,"defineProperty"],[66,23,128,0],[66,24,128,0,"exports"],[66,31,128,0],[67,4,128,0,"enumerable"],[67,14,128,0],[68,4,128,0,"get"],[68,7,128,0],[68,18,128,0,"get"],[68,19,128,0],[69,6,128,0],[69,13,128,0,"addToQueue"],[69,23,128,0],[70,4,128,0],[71,2,128,0],[72,2,138,0,"Object"],[72,8,138,0],[72,9,138,0,"defineProperty"],[72,23,138,0],[72,24,138,0,"exports"],[72,31,138,0],[73,4,138,0,"enumerable"],[73,14,138,0],[74,4,138,0,"get"],[74,7,138,0],[74,18,138,0,"get"],[74,19,138,0],[75,6,138,0],[75,13,138,0,"removeFromQueue"],[75,28,138,0],[76,4,138,0],[77,2,138,0],[78,2,145,0,"Object"],[78,8,145,0],[78,9,145,0,"defineProperty"],[78,23,145,0],[78,24,145,0,"exports"],[78,31,145,0],[79,4,145,0,"enumerable"],[79,14,145,0],[80,4,145,0,"get"],[80,7,145,0],[80,18,145,0,"get"],[80,19,145,0],[81,6,145,0],[81,13,145,0,"subscribeToNewMessages"],[81,35,145,0],[82,4,145,0],[83,2,145,0],[84,2,1,0],[84,6,1,0,"_firebaseDatabase"],[84,23,1,0],[84,26,1,0,"require"],[84,33,1,0],[84,34,1,0,"_dependencyMap"],[84,48,1,0],[85,2,2,0],[85,6,2,0,"_configFirebase"],[85,21,2,0],[85,24,2,0,"require"],[85,31,2,0],[85,32,2,0,"_dependencyMap"],[85,46,2,0],[86,2,3,0],[86,6,3,0,"_reactNativeAsyncStorageAsyncStorage"],[86,42,3,0],[86,45,3,0,"require"],[86,52,3,0],[86,53,3,0,"_dependencyMap"],[86,67,3,0],[87,2,3,0],[87,6,3,0,"AsyncStorage"],[87,18,3,0],[87,21,3,0,"_interopDefault"],[87,36,3,0],[87,37,3,0,"_reactNativeAsyncStorageAsyncStorage"],[87,73,3,0],[88,2,15,0],[88,8,15,6,"QUEUE_KEY"],[88,17,15,15],[88,20,15,18],[88,42,15,40],[89,2,16,0],[89,8,16,6,"MESSAGES_KEY"],[89,20,16,18],[89,23,16,21],[89,41,16,39],[91,2,18,0],[92,2,19,7],[92,8,19,13,"generateMessageId"],[92,25,19,30],[92,28,19,33,"generateMessageId"],[92,29,19,33],[92,34,19,47],[93,4,20,2],[93,11,20,9],[93,14,20,12,"Date"],[93,18,20,16],[93,19,20,17,"now"],[93,22,20,20],[93,23,20,21],[93,24,20,22],[93,28,20,26,"Math"],[93,32,20,30],[93,33,20,31,"random"],[93,39,20,37],[93,40,20,38],[93,41,20,39],[93,42,20,40,"toString"],[93,50,20,48],[93,51,20,49],[93,53,20,51],[93,54,20,52],[93,55,20,53,"substr"],[93,61,20,59],[93,62,20,60],[93,63,20,61],[93,65,20,63],[93,66,20,64],[93,67,20,65],[93,69,20,67],[94,2,21,0],[94,3,21,1],[96,2,23,0],[97,2,24,7],[97,8,24,13,"getChatId"],[97,17,24,22],[97,20,24,25,"getChatId"],[97,21,24,26,"phone1"],[97,27,24,40],[97,29,24,42,"phone2"],[97,35,24,56],[97,40,24,69],[98,4,25,2],[98,10,25,8,"sorted"],[98,16,25,14],[98,19,25,17],[98,20,25,18,"phone1"],[98,26,25,24],[98,28,25,26,"phone2"],[98,34,25,32],[98,35,25,33],[98,36,25,34,"sort"],[98,40,25,38],[98,41,25,39],[98,42,25,40],[99,4,26,2],[99,11,26,9],[99,14,26,12,"sorted"],[99,20,26,18],[99,21,26,19],[99,22,26,20],[99,23,26,21],[99,27,26,25,"sorted"],[99,33,26,31],[99,34,26,32],[99,35,26,33],[99,36,26,34],[99,38,26,36],[100,2,27,0],[100,3,27,1],[102,2,29,0],[103,2,30,7],[103,8,30,13,"saveMessagesLocally"],[103,27,30,32],[103,30,30,35],[103,36,30,35,"saveMessagesLocally"],[103,37,30,42,"chatId"],[103,43,30,56],[103,45,30,58,"messages"],[103,53,30,77],[103,58,30,97],[104,4,31,2],[104,8,31,6],[105,6,32,4],[105,12,32,10,"AsyncStorage"],[105,24,32,22],[105,25,32,22,"default"],[105,32,32,22],[105,33,32,23,"setItem"],[105,40,32,30],[105,41,32,31,"MESSAGES_KEY"],[105,53,32,43],[105,56,32,46,"chatId"],[105,62,32,52],[105,64,32,54,"JSON"],[105,68,32,58],[105,69,32,59,"stringify"],[105,78,32,68],[105,79,32,69,"messages"],[105,87,32,77],[105,88,32,78],[105,89,32,79],[106,4,33,2],[106,5,33,3],[106,6,33,4],[106,13,33,11,"e"],[106,14,33,12],[106,16,33,14],[107,6,34,4,"console"],[107,13,34,11],[107,14,34,12,"log"],[107,17,34,15],[107,18,34,16],[107,50,34,48],[107,52,34,50,"e"],[107,53,34,51],[107,54,34,52],[108,4,35,2],[109,2,36,0],[109,3,36,1],[111,2,38,0],[112,2,39,7],[112,8,39,13,"getLocalMessages"],[112,24,39,29],[112,27,39,32],[112,33,39,39,"chatId"],[112,39,39,53],[112,43,39,78],[113,4,40,2],[113,8,40,6],[114,6,41,4],[114,12,41,10,"data"],[114,16,41,14],[114,19,41,17],[114,25,41,23,"AsyncStorage"],[114,37,41,35],[114,38,41,35,"default"],[114,45,41,35],[114,46,41,36,"getItem"],[114,53,41,43],[114,54,41,44,"MESSAGES_KEY"],[114,66,41,56],[114,69,41,59,"chatId"],[114,75,41,65],[114,76,41,66],[115,6,42,4],[115,13,42,11,"data"],[115,17,42,15],[115,20,42,18,"JSON"],[115,24,42,22],[115,25,42,23,"parse"],[115,30,42,28],[115,31,42,29,"data"],[115,35,42,33],[115,36,42,34],[115,39,42,37],[115,41,42,39],[116,4,43,2],[116,5,43,3],[116,6,43,4],[116,13,43,11,"e"],[116,14,43,12],[116,16,43,14],[117,6,44,4,"console"],[117,13,44,11],[117,14,44,12,"log"],[117,17,44,15],[117,18,44,16],[117,49,44,47],[117,51,44,49,"e"],[117,52,44,50],[117,53,44,51],[118,6,45,4],[118,13,45,11],[118,15,45,13],[119,4,46,2],[120,2,47,0],[120,3,47,1],[122,2,49,0],[123,2,50,7],[123,8,50,13,"addMessageLocally"],[123,25,50,30],[123,28,50,33],[123,34,50,33,"addMessageLocally"],[123,35,50,40,"chatId"],[123,41,50,54],[123,43,50,56,"message"],[123,50,50,72],[123,55,50,92],[124,4,51,2],[124,8,51,6],[125,6,52,4],[125,12,52,10,"messages"],[125,20,52,18],[125,23,52,21],[125,29,52,27,"getLocalMessages"],[125,45,52,43],[125,46,52,44,"chatId"],[125,52,52,50],[125,53,52,51],[126,6,53,4],[126,12,53,10,"exists"],[126,18,53,16],[126,21,53,19,"messages"],[126,29,53,27],[126,30,53,28,"find"],[126,34,53,32],[126,35,53,33,"m"],[126,36,53,34],[126,40,53,38,"m"],[126,41,53,39],[126,42,53,40,"id"],[126,44,53,42],[126,49,53,47,"message"],[126,56,53,54],[126,57,53,55,"id"],[126,59,53,57],[126,60,53,58],[127,6,54,4],[127,10,54,8],[127,11,54,9,"exists"],[127,17,54,15],[127,19,54,17],[128,8,55,6,"messages"],[128,16,55,14],[128,17,55,15,"push"],[128,21,55,19],[128,22,55,20,"message"],[128,29,55,27],[128,30,55,28],[129,8,56,6],[130,8,57,6],[130,14,57,12,"trimmed"],[130,21,57,19],[130,24,57,22,"messages"],[130,32,57,30],[130,33,57,31,"slice"],[130,38,57,36],[130,39,57,37],[130,40,57,38],[130,43,57,41],[130,44,57,42],[131,8,58,6],[131,14,58,12,"saveMessagesLocally"],[131,33,58,31],[131,34,58,32,"chatId"],[131,40,58,38],[131,42,58,40,"trimmed"],[131,49,58,47],[131,50,58,48],[132,6,59,4],[133,4,60,2],[133,5,60,3],[133,6,60,4],[133,13,60,11,"e"],[133,14,60,12],[133,16,60,14],[134,6,61,4,"console"],[134,13,61,11],[134,14,61,12,"log"],[134,17,61,15],[134,18,61,16],[134,49,61,47],[134,51,61,49,"e"],[134,52,61,50],[134,53,61,51],[135,4,62,2],[136,2,63,0],[136,3,63,1],[138,2,65,0],[139,2,66,7],[139,8,66,13,"updateMessageStatusLocally"],[139,34,66,39],[139,37,66,42],[139,43,66,42,"updateMessageStatusLocally"],[139,44,67,2,"chatId"],[139,50,67,16],[139,52,68,2,"messageId"],[139,61,68,19],[139,63,69,2,"status"],[139,69,69,23],[139,74,70,20],[140,4,71,2],[140,8,71,6],[141,6,72,4],[141,12,72,10,"messages"],[141,20,72,18],[141,23,72,21],[141,29,72,27,"getLocalMessages"],[141,45,72,43],[141,46,72,44,"chatId"],[141,52,72,50],[141,53,72,51],[142,6,73,4],[142,12,73,10,"index"],[142,17,73,15],[142,20,73,18,"messages"],[142,28,73,26],[142,29,73,27,"findIndex"],[142,38,73,36],[142,39,73,37,"m"],[142,40,73,38],[142,44,73,42,"m"],[142,45,73,43],[142,46,73,44,"id"],[142,48,73,46],[142,53,73,51,"messageId"],[142,62,73,60],[142,63,73,61],[143,6,74,4],[143,10,74,8,"index"],[143,15,74,13],[143,20,74,18],[143,21,74,19],[143,22,74,20],[143,24,74,22],[144,8,75,6,"messages"],[144,16,75,14],[144,17,75,15,"index"],[144,22,75,20],[144,23,75,21],[144,24,75,22,"status"],[144,30,75,28],[144,33,75,31,"status"],[144,39,75,37],[145,8,76,6],[145,14,76,12,"saveMessagesLocally"],[145,33,76,31],[145,34,76,32,"chatId"],[145,40,76,38],[145,42,76,40,"messages"],[145,50,76,48],[145,51,76,49],[146,6,77,4],[147,4,78,2],[147,5,78,3],[147,6,78,4],[147,13,78,11,"e"],[147,14,78,12],[147,16,78,14],[148,6,79,4,"console"],[148,13,79,11],[148,14,79,12,"log"],[148,17,79,15],[148,18,79,16],[148,50,79,48],[148,52,79,50,"e"],[148,53,79,51],[148,54,79,52],[149,4,80,2],[150,2,81,0],[150,3,81,1],[152,2,83,0],[153,2,84,7],[153,8,84,13,"sendMessageToFirebase"],[153,29,84,34],[153,32,84,37],[153,38,84,37,"sendMessageToFirebase"],[153,39,85,2,"chatId"],[153,45,85,16],[153,47,86,2,"message"],[153,54,86,18],[153,59,87,23],[154,4,88,2],[154,8,88,6],[155,6,89,4],[155,12,89,10,"messageRef"],[155,22,89,20],[155,25,89,23],[155,29,89,23,"ref"],[155,46,89,26],[155,47,89,26,"ref"],[155,50,89,26],[155,52,89,27,"database"],[155,67,89,35],[155,68,89,35,"database"],[155,76,89,35],[155,78,89,37],[155,87,89,46,"chatId"],[155,93,89,52],[155,106,89,65,"message"],[155,113,89,72],[155,114,89,73,"id"],[155,116,89,75],[155,118,89,77],[155,119,89,78],[156,6,90,4],[156,12,90,10],[156,16,90,10,"set"],[156,33,90,13],[156,34,90,13,"set"],[156,37,90,13],[156,39,90,14,"messageRef"],[156,49,90,24],[156,51,90,26],[157,8,91,6,"text"],[157,12,91,10],[157,14,91,12,"message"],[157,21,91,19],[157,22,91,20,"text"],[157,26,91,24],[158,8,92,6,"sender"],[158,14,92,12],[158,16,92,14,"message"],[158,23,92,21],[158,24,92,22,"sender"],[158,30,92,28],[159,8,93,6,"timestamp"],[159,17,93,15],[159,19,93,17,"message"],[159,26,93,24],[159,27,93,25,"timestamp"],[159,36,93,34],[160,8,94,6,"status"],[160,14,94,12],[160,16,94,14],[161,6,95,4],[161,7,95,5],[161,8,95,6],[162,6,96,4],[162,13,96,11],[162,17,96,15],[163,4,97,2],[163,5,97,3],[163,6,97,4],[163,13,97,11,"e"],[163,14,97,12],[163,16,97,14],[164,6,98,4,"console"],[164,13,98,11],[164,14,98,12,"log"],[164,17,98,15],[164,18,98,16],[164,40,98,38],[164,42,98,40,"e"],[164,43,98,41],[164,44,98,42],[165,6,99,4],[165,13,99,11],[165,18,99,16],[166,4,100,2],[167,2,101,0],[167,3,101,1],[169,2,103,0],[171,2,110,7],[171,8,110,13,"getMessageQueue"],[171,23,110,28],[171,26,110,31],[171,32,110,31,"getMessageQueue"],[171,33,110,31],[171,38,110,69],[172,4,111,2],[172,8,111,6],[173,6,112,4],[173,12,112,10,"data"],[173,16,112,14],[173,19,112,17],[173,25,112,23,"AsyncStorage"],[173,37,112,35],[173,38,112,35,"default"],[173,45,112,35],[173,46,112,36,"getItem"],[173,53,112,43],[173,54,112,44,"QUEUE_KEY"],[173,63,112,53],[173,64,112,54],[174,6,113,4],[174,13,113,11,"data"],[174,17,113,15],[174,20,113,18,"JSON"],[174,24,113,22],[174,25,113,23,"parse"],[174,30,113,28],[174,31,113,29,"data"],[174,35,113,33],[174,36,113,34],[174,39,113,37],[174,41,113,39],[175,4,114,2],[175,5,114,3],[175,6,114,4],[175,13,114,11,"e"],[175,14,114,12],[175,16,114,14],[176,6,115,4,"console"],[176,13,115,11],[176,14,115,12,"log"],[176,17,115,15],[176,18,115,16],[176,40,115,38],[176,42,115,40,"e"],[176,43,115,41],[176,44,115,42],[177,6,116,4],[177,13,116,11],[177,15,116,13],[178,4,117,2],[179,2,118,0],[179,3,118,1],[180,2,120,7],[180,8,120,13,"saveMessageQueue"],[180,24,120,29],[180,27,120,32],[180,33,120,39,"queue"],[180,38,120,61],[180,42,120,81],[181,4,121,2],[181,8,121,6],[182,6,122,4],[182,12,122,10,"AsyncStorage"],[182,24,122,22],[182,25,122,22,"default"],[182,32,122,22],[182,33,122,23,"setItem"],[182,40,122,30],[182,41,122,31,"QUEUE_KEY"],[182,50,122,40],[182,52,122,42,"JSON"],[182,56,122,46],[182,57,122,47,"stringify"],[182,66,122,56],[182,67,122,57,"queue"],[182,72,122,62],[182,73,122,63],[182,74,122,64],[183,4,123,2],[183,5,123,3],[183,6,123,4],[183,13,123,11,"e"],[183,14,123,12],[183,16,123,14],[184,6,124,4,"console"],[184,13,124,11],[184,14,124,12,"log"],[184,17,124,15],[184,18,124,16],[184,39,124,37],[184,41,124,39,"e"],[184,42,124,40],[184,43,124,41],[185,4,125,2],[186,2,126,0],[186,3,126,1],[187,2,128,7],[187,8,128,13,"addToQueue"],[187,18,128,23],[187,21,128,26],[187,27,128,26,"addToQueue"],[187,28,128,33,"chatId"],[187,34,128,47],[187,36,128,49,"message"],[187,43,128,65],[187,48,128,85],[188,4,129,2],[188,10,129,8,"queue"],[188,15,129,13],[188,18,129,16],[188,24,129,22,"getMessageQueue"],[188,39,129,37],[188,40,129,38],[188,41,129,39],[189,4,130,2],[190,4,131,2],[190,10,131,8,"exists"],[190,16,131,14],[190,19,131,17,"queue"],[190,24,131,22],[190,25,131,23,"find"],[190,29,131,27],[190,30,131,28,"q"],[190,31,131,29],[190,35,131,33,"q"],[190,36,131,34],[190,37,131,35,"message"],[190,44,131,42],[190,45,131,43,"id"],[190,47,131,45],[190,52,131,50,"message"],[190,59,131,57],[190,60,131,58,"id"],[190,62,131,60],[190,63,131,61],[191,4,132,2],[191,8,132,6],[191,9,132,7,"exists"],[191,15,132,13],[191,17,132,15],[192,6,133,4,"queue"],[192,11,133,9],[192,12,133,10,"push"],[192,16,133,14],[192,17,133,15],[193,8,133,17,"chatId"],[193,14,133,23],[194,8,133,25,"message"],[194,15,133,32],[195,8,133,34,"retryCount"],[195,18,133,44],[195,20,133,46],[196,6,133,48],[196,7,133,49],[196,8,133,50],[197,6,134,4],[197,12,134,10,"saveMessageQueue"],[197,28,134,26],[197,29,134,27,"queue"],[197,34,134,32],[197,35,134,33],[198,4,135,2],[199,2,136,0],[199,3,136,1],[200,2,138,7],[200,8,138,13,"removeFromQueue"],[200,23,138,28],[200,26,138,31],[200,32,138,38,"messageId"],[200,41,138,55],[200,45,138,75],[201,4,139,2],[201,10,139,8,"queue"],[201,15,139,13],[201,18,139,16],[201,24,139,22,"getMessageQueue"],[201,39,139,37],[201,40,139,38],[201,41,139,39],[202,4,140,2],[202,10,140,8,"filtered"],[202,18,140,16],[202,21,140,19,"queue"],[202,26,140,24],[202,27,140,25,"filter"],[202,33,140,31],[202,34,140,32,"q"],[202,35,140,33],[202,39,140,37,"q"],[202,40,140,38],[202,41,140,39,"message"],[202,48,140,46],[202,49,140,47,"id"],[202,51,140,49],[202,56,140,54,"messageId"],[202,65,140,63],[202,66,140,64],[203,4,141,2],[203,10,141,8,"saveMessageQueue"],[203,26,141,24],[203,27,141,25,"filtered"],[203,35,141,33],[203,36,141,34],[204,2,142,0],[204,3,142,1],[206,2,144,0],[207,2,145,7],[207,8,145,13,"subscribeToNewMessages"],[207,30,145,35],[207,33,145,38,"subscribeToNewMessages"],[207,34,146,2,"chatId"],[207,40,146,16],[207,42,147,2,"lastTimestamp"],[207,55,147,23],[207,57,148,2,"onNewMessage"],[207,69,148,42],[207,74,149,19],[208,4,150,2],[208,10,150,8,"messagesRef"],[208,21,150,19],[208,24,150,22],[208,28,150,22,"ref"],[208,45,150,25],[208,46,150,25,"ref"],[208,49,150,25],[208,51,150,26,"database"],[208,66,150,34],[208,67,150,34,"database"],[208,75,150,34],[208,77,150,36],[208,86,150,45,"chatId"],[208,92,150,51],[208,103,150,62],[208,104,150,63],[209,4,151,2],[209,10,151,8,"messagesQuery"],[209,23,151,21],[209,26,151,24],[209,30,151,24,"query"],[209,47,151,29],[209,48,151,29,"query"],[209,53,151,29],[209,55,152,4,"messagesRef"],[209,66,152,15],[209,68,153,4],[209,72,153,4,"orderByChild"],[209,89,153,16],[209,90,153,16,"orderByChild"],[209,102,153,16],[209,104,153,17],[209,115,153,28],[209,116,153,29],[209,118,154,4],[209,122,154,4,"startAt"],[209,139,154,11],[209,140,154,11,"startAt"],[209,147,154,11],[209,149,154,12,"lastTimestamp"],[209,162,154,25],[209,165,154,28],[209,166,154,29],[209,167,155,2],[209,168,155,3],[210,4,157,2],[210,10,157,8,"callback"],[210,18,157,16],[210,21,157,19],[210,25,157,19,"onChildAdded"],[210,42,157,31],[210,43,157,31,"onChildAdded"],[210,55,157,31],[210,57,157,32,"messagesQuery"],[210,70,157,45],[210,72,157,48,"snapshot"],[210,80,157,56],[210,84,157,61],[211,6,158,4],[211,10,158,8,"snapshot"],[211,18,158,16],[211,19,158,17,"exists"],[211,25,158,23],[211,26,158,24],[211,27,158,25],[211,29,158,27],[212,8,159,6],[212,14,159,12,"data"],[212,18,159,16],[212,21,159,19,"snapshot"],[212,29,159,27],[212,30,159,28,"val"],[212,33,159,31],[212,34,159,32],[212,35,159,33],[213,8,160,6],[213,14,160,12,"message"],[213,21,160,28],[213,24,160,31],[214,10,161,8,"id"],[214,12,161,10],[214,14,161,12,"snapshot"],[214,22,161,20],[214,23,161,21,"key"],[214,26,161,24],[214,30,161,28,"generateMessageId"],[214,47,161,45],[214,48,161,46],[214,49,161,47],[215,10,162,8,"text"],[215,14,162,12],[215,16,162,14,"data"],[215,20,162,18],[215,21,162,19,"text"],[215,25,162,23],[216,10,163,8,"sender"],[216,16,163,14],[216,18,163,16,"data"],[216,22,163,20],[216,23,163,21,"sender"],[216,29,163,27],[217,10,164,8,"timestamp"],[217,19,164,17],[217,21,164,19,"data"],[217,25,164,23],[217,26,164,24,"timestamp"],[217,35,164,33],[218,10,165,8,"status"],[218,16,165,14],[218,18,165,16],[219,8,166,6],[219,9,166,7],[220,8,167,6,"onNewMessage"],[220,20,167,18],[220,21,167,19,"message"],[220,28,167,26],[220,29,167,27],[221,6,168,4],[222,4,169,2],[222,5,169,3],[222,6,169,4],[224,4,171,2],[225,4,172,2],[225,11,172,9],[225,17,172,15],[226,6,173,4],[226,10,173,4,"off"],[226,27,173,7],[226,28,173,7,"off"],[226,31,173,7],[226,33,173,8,"messagesRef"],[226,44,173,19],[226,45,173,20],[227,4,174,2],[227,5,174,3],[228,2,175,0],[228,3,175,1],[229,0,175,2],[229,3]],"functionMap":{"names":["<global>","generateMessageId","getChatId","saveMessagesLocally","getLocalMessages","addMessageLocally","messages.find$argument_0","updateMessageStatusLocally","messages.findIndex$argument_0","sendMessageToFirebase","getMessageQueue","saveMessageQueue","addToQueue","queue.find$argument_0","removeFromQueue","queue.filter$argument_0","subscribeToNewMessages","onChildAdded$argument_1","<anonymous>"],"mappings":"AAA;iCCkB;CDE;yBEG;CFG;mCGG;CHM;gCIG;CJQ;iCKG;iCCG,wBD;CLU;0COG;qCCO,uBD;CPQ;qCSG;CTiB;+BUS;CVQ;gCWE;CXM;0BYE;4BCG,gCD;CZK;+BcE;gCCE,+BD;CdE;sCgBG;+CCY;GDY;SEG;GFE;ChBC"},"hasCjsExports":false},"type":"js/module"}]}